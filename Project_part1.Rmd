---
title: "Project Part 1" 
author: "CJ Onibala and Ray Santiago"
date: "2025-11-04"
fontsize: 12pt
geometry: margin=1in
urlcolor: black
output: pdf_document
header-includes:
- \usepackage{setspace}
- \onehalfspacing
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, highlight=FALSE)
```

```{r, echo=FALSE, warning=FALSE, message=FALSE}
## Use this chunk for reading in packages.
## Use this chunk for reading in the data, combining the data, and any other major data cleaning that is not relevant to show.
## Remove the ## before all code.
```

## Introduction
### Subsection headers, if using
UVA Football. The pride and joy of many students here, something that students look forward to each week after a rough week of classes, finals, and life tasks, especially when it’s a home game. The initial question we will explore is whether the team shows greater variability in points scored during home games compared to away games, which indicates whether the team performs consistently or shows more frequent fluctuations in scoring depending on where they play. This brings us to our next question of whether attendance influences the number of points scored by both teams, to see if there is any trend in fan support. This helps identify if fans cheering for the teams truly does hype up the players and allow for more points to be scored. Lastly, we want to explore the potential weakness of our team and see if our 3rd down conversion rate is lower than our opponent’s. This may help determine where our offense crumbles. 

Q1:Does UVA away games have more variablity vs home games
get scores from all games, then compare home vs away in one season
game_stats.txt
Q2: Does attendance influence average amount of points scored by both teams? 
game_stats.txt

Q3: Does UVA convert a lower proportion of 3rd downs than their opponents?

## Data Summary:
 (a) If the data represent a population, explain how the data were collected.
 (b) If the data represent a sample, explain how the data were selected and collected.
 (c) Explain any data modifications after collection and the reasons behind these changes.
 (d) Discuss potential issues with the data and their possible impact.
 (e) Explain why the data are appropriate to answer the research question.

## Exploratory Analysis:
(a) Include at least two numerical and two graphical summaries.
 (b) Display all of the chosen summaries in this section and within the 7-page report
 limit.
 (c) Appropriately label and title all elements of all graphical summaries.
 (d) Numerical summaries can be displayed graphically by displaying the numeric
 values on a corresponding graphic. Two summaries combined in this way are
 considered two of the four summaries.
 (e) Create all summaries in R and all graphical summaries using ggplot2.
  (f) Do NOT perform any statistical inference.
```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
# Read files
game_stats <- read.csv("game_stats.txt", stringsAsFactors = FALSE)
third_downs <- read.csv("third_downs.txt", stringsAsFactors = FALSE)
third_downs_enemy <- read.csv("third_downs_enemy.txt", stringsAsFactors = FALSE)

# Convert dates
game_stats$Date <- as.Date(game_stats$Date, format = "%Y-%m-%d")
third_downs$Date <- as.Date(third_downs$Date, format = "%m/%d/%y")
third_downs_enemy$Date <- as.Date(third_downs_enemy$Date, format = "%m/%d/%y")  # fixed reference

# Select relevant columns and rename for clarity
third_downs_subset <- third_downs %>% select(Date, Opponent, Attempts, Conversions, ConversionPercent)
third_downs_enemy_subset <- third_downs_enemy %>% 
  select(Date, Opponent, EnemyAttempts, EnemyConversions, EnemyConversionPercent)

# Merge UVA and Opponent third downs first by Date and Opponent
conversion_compare <- merge(third_downs_subset, third_downs_enemy_subset, by = c("Date", "Opponent"))

# Optionally merge with game_stats if needed
full_data <- merge(game_stats, conversion_compare, by = c("Date", "Opponent"))


# View the merged dataframe
print(full_data)

# numerical summary:
iqr_summary <- full_data %>%
  group_by(Location) %>%
  summarise(IQR_UVA_Score = IQR(UVA_Score, na.rm=TRUE))

# Graphical summary 1: Boxplot of UVA_Score by Location with IQR values annotated
HomeVAway <- ggplot(full_data, aes(x=Location, y=UVA_Score)) +
  geom_boxplot() +
  geom_text(data = iqr_summary, aes(x=Location, y=max(full_data$UVA_Score, na.rm=TRUE), label = paste("IQR:", round(IQR_UVA_Score, 1))), inherit.aes=FALSE, vjust=-0.5) +
  labs(title = "Boxplot of UVA Scores by Game Location", x = "Game Location", y = "UVA Score")
ggsave("plots/HomeVAway.png", plot = HomeVAway, width = 6, height = 4)
HomeVAway

# Graphical Summary 2: attendance vs score

# Reshape the data to long format with scores stacked
long_data <- full_data %>%
  select(Date, Opponent, Attendance, UVA_Score, Opponent_Score) %>%
  pivot_longer(cols = c(UVA_Score, Opponent_Score),
               names_to = "Team",
               values_to = "Score")

# Create a new column for total score
full_data <- full_data %>%
  mutate(Total_Score = UVA_Score + Opponent_Score)

# Plot Attendance vs Total Score
AttendVScore <- ggplot(full_data, aes(x = Attendance, y = Total_Score)) +
  geom_point(color = "blue", size = 3) +
  geom_text(aes(label = Total_Score), nudge_y = 2, size = 3) +  # Add numbers above points
  labs(title = "Attendance vs Total Points Scored",
       x = "Attendance",
       y = "Total Points (UVA + Opponent)")
ggsave("plots/AttendanceVScore.png", plot = AttendVScore, width = 6, height = 4)
AttendVScore

# Graphical Summary 3: Difference in 3rd Down Conversion %: UVA minus Opponents
plot_data <- full_data %>%
  select(Date, Opponent, ConversionPercent, EnemyConversionPercent) %>%
  pivot_longer(cols = c(ConversionPercent, EnemyConversionPercent),
               names_to = "Team", values_to = "ConversionPercent")

# Numerical Summary 2: Calculate difference: UVA - Opponent conversion percentage
full_data <- full_data %>%
  mutate(DifferencePercent = ConversionPercent - EnemyConversionPercent)

# Plot Difference over time (by Date)
ThirdDownConversion <-ggplot(full_data, aes(x = Date, y = DifferencePercent)) +
  geom_line(color = "pink", size = 1) +
  geom_point(color = "pink", size = 3) +
  geom_text(aes(label = round(DifferencePercent, 1)), nudge_y = -5, size = 3) +  # numbers above points for numerical summary
  geom_hline(yintercept = 0, linetype = "dashed", color = "gray") +
  labs(title = "Difference in 3rd Down Conversion %: UVA minus Opponents",
       x = "Game Date",
       y = "Difference in Conversion Percentage") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggsave("plots/3rdDownConversion.png", plot = ThirdDownConversion, width = 6, height = 4)
ThirdDownConversion

```
## Conclusions: 
(a) Interpret the chosen summaries and make initial conclusions based on the information displayed in them.

Interestingly, the away games have a higher scoring average, whereas the home games score less, as evident by the box plot. The higher variability indicates that we are more unpredictable in how much we score in away games. Lastly, our home games seem to be more tightly clustered around an overall lower score count in games.

In the plot of attendance vs total points scored, games with low and high attendance saw higher point totals, with the more middle of the pack attendance counts clustered around lower total points. This may indicate the type of game to expect and how the matchup is expected to turn out.

In the 3rd down conversions, 4 games out of 12 do we have a better rate of 3rd down conversions compared to the other time. Of those 4, only 2 were above 15%. Of the 8 games where we had a worse conversion percent, 3 of the games were by more than 15%, with one being by 37.1%. There seems to be no improvement/worsening in conversion percent the later the season went.
 (b) Interpret the values, trends, and patterns displayed in the chosen summaries statistically.
 
Notably the medians are over 10 points apart, which is a touchdown and a field goal worth of points. But, the variability in away games is slightly more, as depicted by a roughly 2.4 difference in IQR between the two. Lastly, the whiskers in the box plot are higher and lower for away games, showing that away games had a higher amount of points and the highest amount of points in their lowest scoring game.

The 80,000+ attendee game may be an outlier and skew a perception that higher attendance always equals more points scored. The scatter plot suggests a weak correlation and unlikely for there to be a trend between the two, but potentially a different correlation made by team relevance/difficulty that will be talked about later. 

The range in percentages is from -37.1 to 25, signifying a high volatility and variance. There was a decent streak of 3 games between September and October, starting with the 19.2 percent, which may signify a reason for good performance in those games. The standard deviation here appears to be very high. 

 (c) Explain what the values, trends, and patterns displayed in the chosen summaries may mean or imply in the context of the question.
 
 Our initial question ended up being that there is more variability within away games, but surprisingly also higher scoring. This may show that there is more motivation for the players and a "nothing to lose" mindset, alongside that our players do not experience a home field advantage energy. 
 
 In the attendees versus points scored, a potential reason for how the relationship turned out could be accounted for by other factors such as strength of opponent, football legacy, rivalries, and weather. If looking purely at strength of opponent, you can find a pattern that there is a lot of points scored in less attended events because the other team is a lot worse, which means less fans, and in the more attended events you can expect more points because the other team is a lot better, meaning more fans. This data does not exactly answer our question, but rather shows that many factors account for higher points and attendance amounts.

The large negative percentages in 3rd down conversions may highlight major losses, as the game with the highest negative of 37.1, we lost 7-33, which may indicate the degree of loss that the 3rd down conversion may effect. The high volatility may be a sign of inconsistent play-calling or coaching, showing that they are trying different solutions. 
 (d) Summarize the conclusions in the context of the topic of interest.
 
 UVA actually scores more points in away games, with a higher variability in scoring compared to home games, making potentially more "exciting" games to be not at home. Attendance does not effect scoring for teams, showing fan presence is not a major enough factor for offensive forces. Lastly, our 3rd down conversion was lower than the enemy 8/12 games played, which shows that it can impact the outcome of a game. We lost 5/8 of those games when we had a lower conversion rate and is 5/7 of the games we lost. This may show that 3rd down conversion rates can impact UVA's winning chances in games. These insights could inform coaching adjustments, game preparation strategies, and future performance evaluations.
 
 \newpage.
## References:

uva football game stats:https://virginiasports.com/football-stats/
individual game stats:https://cfbstats.com/2024/team/746/thirddown/offense/gamelog.html
enemy game stats: https://cfbstats.com/2024/team/746/thirddown/defense/gamelog.html
github URL:
 (d) If you used AI to produce any portion of any file in your repository, you must
 provide attribution in accordance with UVA guidelines
 

Linebreaks are created using two spaces at the end of the previous line of text, or using the command \newline.  
Pagebreaks are created using the command \newpage.  
Note: These commands execute when knitting, moving the end-of-sentence period in the resulting PDF.

```{r, echo=FALSE}
## R code to create and display summaries in part 1. 
## This R code will not be printed in the PDF.
## Remove the ## before all code.
```



```{r}
## R code to conduct the test in part 2.
## This R code will be printed in the PDF.
## Remove the ## before all code.
```

